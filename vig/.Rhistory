# open data
read.delim('id23_Demand1991.txt',
col.names = "V1") %>%
# remove non-vignette rows
slice(
# start at row after Vignette
(which(. == "Vignette") + 1) :
# stop at end of dataframe
nrow(.)
) %>%
# identify vignette number
mutate(V1 = if_else(grepl("#", .$V1),
substr(V1, 1, 9),
V1)
) %>%
# split at every new vignette
split(cumsum(grepl("#", .$V1))
) %>%
# create separate column for each vignette
map(c) %>%
bind_cols() %>%
# make first row column names
set_names(as.character(slice(., 1))) %>%
slice(-1) %>%
# add sentence number column
mutate(sent = seq.int(nrow(.)))
# pivot long
pivot_longer(cols = -sent)
View(DF)
DF <-
# open data
read.delim('id23_Demand1991.txt',
col.names = "V1") %>%
# remove non-vignette rows
slice(
# start at row after Vignette
(which(. == "Vignette") + 1) :
# stop at end of dataframe
nrow(.)
) %>%
# identify vignette number
mutate(V1 = if_else(grepl("#", .$V1),
substr(V1, 1, 9),
V1)
) %>%
# split at every new vignette
split(cumsum(grepl("#", .$V1))
) %>%
# create separate column for each vignette
map(c) %>%
bind_cols() %>%
# make first row column names
set_names(as.character(slice(., 1))) %>%
slice(-1) %>%
# add sentence number column
mutate(sent = seq.int(nrow(.))) %>%
# pivot long
pivot_longer(cols = -sent)
View(DF)
?pivot_wider
DF <-
# open data
read.delim('id23_Demand1991.txt',
col.names = "V1") %>%
# remove non-vignette rows
slice(
# start at row after Vignette
(which(. == "Vignette") + 1) :
# stop at end of dataframe
nrow(.)
) %>%
# identify vignette number
mutate(V1 = if_else(grepl("#", .$V1),
substr(V1, 1, 9),
V1)
) %>%
# split at every new vignette
split(cumsum(grepl("#", .$V1))
) %>%
# create separate column for each vignette
map(c) %>%
bind_cols() %>%
# make first row column names
set_names(as.character(slice(., 1))) %>%
slice(-1) %>%
# add sentence number column
mutate(sent = seq.int(nrow(.))) %>%
# pivot long then wide
pivot_longer(cols = -sent) %>%
pivot_wider(names_from = sent,
values_from = value)
View(DF)
# Chunk 1: setup and load packages
# clean environment
rm(list = ls())
# load packages
ipak <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
if (length(new.pkg))
install.packages(new.pkg, dependencies = TRUE)
sapply(pkg, require, character.only = TRUE)
}
# call package function
packages <- c('tidyverse')
ipak(packages)
rm(packages, ipak)
# Chunk 2
DF <-
# open data
read.delim('id23_Demand1991.txt',
col.names = "V1") %>%
# remove non-vignette rows
slice(
# start at row after Vignette
(which(. == "Vignette") + 1) :
# stop at end of dataframe
nrow(.)
) %>%
# identify vignette number
mutate(V1 = if_else(grepl("#", .$V1),
substr(V1, 1, 9),
V1)
) %>%
# split at every new vignette
split(cumsum(grepl("#", .$V1))
) %>%
# create separate column for each vignette
map(c) %>%
bind_cols() %>%
# move first row to column names
set_names(as.character(slice(., 1))) %>%
slice(-1) %>%
# add sentence number column
mutate(sent = seq.int(nrow(.))) %>%
# pivot long then wide
pivot_longer(cols = -sent) %>%
pivot_wider(names_from = sent,
values_from = value)
write.csv(DF, 'metaware.vig.csv')
write.csv(DF, 'metaware.vig.csv',
row.names = F)
write.csv(DF, 'metaware.vig.csv',
row.names = F)
DF <-
# open data
read.delim('id23_Demand1991.txt',
col.names = "V1") %>%
# remove non-vignette rows
slice(
# start at row after Vignette
(which(. == "Vignette") + 1) :
# stop at end of dataframe
nrow(.)
) %>%
# identify vignette number
mutate(V1 = if_else(grepl("#", .$V1),
substr(V1, 1, 9),
V1)
) %>%
# split at every new vignette
split(cumsum(grepl("#", .$V1))
) %>%
# create separate column for each vignette
map(c) %>%
bind_cols() %>%
# move first row to column names
set_names(as.character(slice(., 1))) %>%
slice(-1)
View(DF)
DF <-
# open data
read.delim('id23_Demand1991.txt',
col.names = "V1") %>%
# remove non-vignette rows
slice(
# start at row after Vignette
(which(. == "Vignette") + 1) :
# stop at end of dataframe
nrow(.)
) %>%
# identify vignette number
mutate(V1 = if_else(grepl("#", .$V1),
substr(V1, 1, 9),
V1)
) %>%
# split at every new vignette
split(cumsum(grepl("#", .$V1))
) %>%
# create separate column for each vignette
map(c) %>%
bind_cols() %>%
# move first row to column names
set_names(as.character(slice(., 1))) %>%
slice(-1) %>%
# add sentence number column
mutate(sent = seq.int(nrow(.))) %>%
# pivot long then wide
pivot_longer(cols = -sent)
View(DF)
?str_count
DF <-
# open data
read.delim('id23_Demand1991.txt',
col.names = "V1") %>%
# remove non-vignette rows
slice(
# start at row after Vignette
(which(. == "Vignette") + 1) :
# stop at end of dataframe
nrow(.)
) %>%
# identify vignette number
mutate(V1 = if_else(grepl("#", .$V1),
substr(V1, 1, 9),
V1)
) %>%
# split at every new vignette
split(cumsum(grepl("#", .$V1))
) %>%
# create separate column for each vignette
map(c) %>%
bind_cols() %>%
# move first row to column names
set_names(as.character(slice(., 1))) %>%
slice(-1) %>%
# add sentence number column
mutate(sent = seq.int(nrow(.))) %>%
# pivot long
pivot_longer(cols = -sent) %>%
# estimate reading time
mutate(rt = str_count(value, "\\w+"))
View(DF)
DF <-
# open data
read.delim('id23_Demand1991.txt',
col.names = "V1") %>%
# remove non-vignette rows
slice(
# start at row after Vignette
(which(. == "Vignette") + 1) :
# stop at end of dataframe
nrow(.)
) %>%
# identify vignette number
mutate(V1 = if_else(grepl("#", .$V1),
substr(V1, 1, 9),
V1)
) %>%
# split at every new vignette
split(cumsum(grepl("#", .$V1))
) %>%
# create separate column for each vignette
map(c) %>%
bind_cols() %>%
# move first row to column names
set_names(as.character(slice(., 1))) %>%
slice(-1) %>%
# add sentence number column
mutate(sent = seq.int(nrow(.))) %>%
# pivot long
pivot_longer(cols = -sent) %>%
# estimate reading time (200 words per minute)
mutate(
# estimate # of words
word.num = str_count(value, "\\w+"),
# estimate reading time
rt = word.num / 200)
View(DF)
DF <-
# open data
read.delim('id23_Demand1991.txt',
col.names = "V1") %>%
# remove non-vignette rows
slice(
# start at row after Vignette
(which(. == "Vignette") + 1) :
# stop at end of dataframe
nrow(.)
) %>%
# identify vignette number
mutate(V1 = if_else(grepl("#", .$V1),
substr(V1, 1, 9),
V1)
) %>%
# split at every new vignette
split(cumsum(grepl("#", .$V1))
) %>%
# create separate column for each vignette
map(c) %>%
bind_cols() %>%
# move first row to column names
set_names(as.character(slice(., 1))) %>%
slice(-1) %>%
# add sentence number column
mutate(sent = seq.int(nrow(.))) %>%
# pivot long
pivot_longer(cols = -sent) %>%
# estimate reading time in second (200 words per minute)
mutate(
# estimate # of words
word.num = str_count(value, "\\w+"),
# estimate reading time
rt = (word.num / 200) * .60)
View(DF)
DF <-
# open data
read.delim('id23_Demand1991.txt',
col.names = "V1") %>%
# remove non-vignette rows
slice(
# start at row after Vignette
(which(. == "Vignette") + 1) :
# stop at end of dataframe
nrow(.)
) %>%
# identify vignette number
mutate(V1 = if_else(grepl("#", .$V1),
substr(V1, 1, 9),
V1)
) %>%
# split at every new vignette
split(cumsum(grepl("#", .$V1))
) %>%
# create separate column for each vignette
map(c) %>%
bind_cols() %>%
# move first row to column names
set_names(as.character(slice(., 1))) %>%
slice(-1) %>%
# add sentence number column
mutate(sent = seq.int(nrow(.))) %>%
# pivot long
pivot_longer(cols = -sent) %>%
# estimate reading time in second (200 words per minute)
mutate(
# estimate # of words
word.num = str_count(value, "\\w+"),
# estimate reading time
rt = (word.num / 200) * 60)
DF <-
# open data
read.delim('id23_Demand1991.txt',
col.names = "V1") %>%
# remove non-vignette rows
slice(
# start at row after Vignette
(which(. == "Vignette") + 1) :
# stop at end of dataframe
nrow(.)
) %>%
# identify vignette number
mutate(V1 = if_else(grepl("#", .$V1),
substr(V1, 1, 9),
V1)
) %>%
# split at every new vignette
split(cumsum(grepl("#", .$V1))
) %>%
# create separate column for each vignette
map(c) %>%
bind_cols() %>%
# move first row to column names
set_names(as.character(slice(., 1))) %>%
slice(-1) %>%
# add sentence number column
mutate(sent = seq.int(nrow(.))) %>%
# pivot long
pivot_longer(cols = -sent) %>%
# estimate reading time in second (200 words per minute)
mutate(
# estimate # of words
word.num = str_count(value, "\\w+"),
# estimate reading time
rt = (word.num / 200) * 60) %>%
select(-word.num) %>%
# pivot wider
pivot_wider(names_from = sent,
values_from = value)
DF <-
# open data
read.delim('id23_Demand1991.txt',
col.names = "V1") %>%
# remove non-vignette rows
slice(
# start at row after Vignette
(which(. == "Vignette") + 1) :
# stop at end of dataframe
nrow(.)
) %>%
# identify vignette number
mutate(V1 = if_else(grepl("#", .$V1),
substr(V1, 1, 9),
V1)
) %>%
# split at every new vignette
split(cumsum(grepl("#", .$V1))
) %>%
# create separate column for each vignette
map(c) %>%
bind_cols() %>%
# move first row to column names
set_names(as.character(slice(., 1))) %>%
slice(-1) %>%
# add sentence number column
mutate(sent = seq.int(nrow(.))) %>%
# pivot long
pivot_longer(cols = -sent) %>%
# estimate reading time in second (200 words per minute)
mutate(
# estimate # of words
word.num = str_count(value, "\\w+"),
# estimate reading time
rt = (word.num / 200) * 60) %>%
select(-word.num)
DF <-
# open data
read.delim('id23_Demand1991.txt',
col.names = "V1") %>%
# remove non-vignette rows
slice(
# start at row after Vignette
(which(. == "Vignette") + 1) :
# stop at end of dataframe
nrow(.)
) %>%
# identify vignette number
mutate(V1 = if_else(grepl("#", .$V1),
substr(V1, 1, 9),
V1)
) %>%
# split at every new vignette
split(cumsum(grepl("#", .$V1))
) %>%
# create separate column for each vignette
map(c) %>%
bind_cols() %>%
# move first row to column names
set_names(as.character(slice(., 1))) %>%
slice(-1) %>%
# add sentence number column
mutate(sent = seq.int(nrow(.))) %>%
# pivot long
pivot_longer(cols = -sent) %>%
# estimate reading time in second (200 words per minute)
mutate(
# estimate # of words
word.num = str_count(value, "\\w+"),
# estimate reading time
rt = (word.num / 200) * 60) %>%
select(-word.num) %>%
# pivot wider
pivot_wider(names_from = sent,
values_from = c(value, rt))
View(DF)
write.csv(DF, 'metaware.vig.csv',
row.names = F)
# Chunk 1: setup and load packages
# clean environment
rm(list = ls())
# load packages
ipak <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
if (length(new.pkg))
install.packages(new.pkg, dependencies = TRUE)
sapply(pkg, require, character.only = TRUE)
}
# call package function
packages <- c('tidyverse')
ipak(packages)
rm(packages, ipak)
# Chunk 2
DF <-
# open data
read.delim('id23_Demand1991.txt',
col.names = "V1") %>%
# remove non-vignette rows
slice(
# start at row after Vignette
(which(. == "Vignette") + 1) :
# stop at end of dataframe
nrow(.)
) %>%
# identify vignette number
mutate(V1 = if_else(grepl("#", .$V1),
substr(V1, 1, 9),
V1)
) %>%
# split at every new vignette
split(cumsum(grepl("#", .$V1))
) %>%
# create separate column for each vignette
map(c) %>%
bind_cols() %>%
# move first row to column names
set_names(as.character(slice(., 1))) %>%
slice(-1) %>%
# add sentence number column
mutate(sent = seq.int(nrow(.))) %>%
# pivot long
pivot_longer(cols = -sent) %>%
# estimate reading time in milliseconds (200 words per minute)
mutate(
# estimate # of words
word.num = str_count(value, "\\w+"),
# estimate reading time
rt = (word.num / 200) * 60 * 1000) %>%
select(-word.num) %>%
# pivot wider
pivot_wider(names_from = sent,
values_from = c(value, rt))
write.csv(DF, 'metaware.vig.csv',
row.names = F)
