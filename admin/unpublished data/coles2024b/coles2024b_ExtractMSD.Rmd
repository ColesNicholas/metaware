---
title: "Extraction of M and SDs from Coles et al. 2024b for demand characteristics meta-analysis"
output: html_document
editor_options: 
  chunk_output_type: console
---
In this study, participants completed a line judgment task.

The study featured a 2 (no information received; information received) x 2 (information received is about the researcher's hypothesis; information received is about typical group responses) x 2 (lines are left justified first; lines are right justified first) fractional factorial design. The first factor was manipulated within-subjects, and the second and third were manipulated between-subjects.

As of June 4, 2024, data for this study have been collected at 6 sites.

```{r}
# set up packages
library(tidyverse)

# open data
DF <- read.csv("coles2024b.csv")
```
 

# Examine distributions
```{r}
# line judgment ratings [descriptives]
## if participants responded to demand/conformity pressure, we should see that they have higher ratings when present with info
ggplot(data = DF,
       aes(x = value,
           fill = info.pres,
           colour = info.pres)) +
  geom_histogram(alpha = .2,
                 position = 'identity')

DF %>% 
  group_by(info.pres) %>% 
  summarise(min = min(value,
                      na.rm = T),
            max = max(value,
                      na.rm = T),
            mean = mean(value,
                        na.rm = T))

# line judgment ratings [analyses]
m <- lmer(value ~ info.pres + 
            (1 | ResponseId) +
            (1 | lab), 
          data = DF)

summary(m)

anova(m)

# line judgment ratings [summary]
DF %>% 
  group_by(lab, info.pres) %>% 
  summarise(m = mean(value,
                     na.rm = T),
            sd = sd(value, 
                    na.rm = T),
            n = n()) %>% 
  pivot_wider(names_from = info.pres,
              values_from = c(n, m, sd)) %>% 
  select(lab, 
         n_no, m_no, sd_no, 
         n_yes, m_yes, sd_yes)

# prq ratings
ggplot(data = DF %>% 
         pivot_longer(cols = prq_g_1 : prq_a_2,
                      names_to = "item",
                      values_to = "rating"),
       aes(x = rating)) +
  facet_wrap(vars(item)) +
  geom_density(alpha = .5)

DF %>% 
  pivot_longer(cols = prq_g_1 : prq_a_2,
                      names_to = "item",
                      values_to = "rating") %>% 
  group_by(item) %>% 
  summarise(n = n(),
            min = min(rating,
                      na.rm = T),
            max = max(rating,
                      na.rm = T),
            mean = mean(rating,
                        na.rm = T))

# look at between country differences in concptualizations
DF <- DF %>% 
  rowwise() %>% 
  mutate(prq_a = mean(c(prq_a_1, prq_a_2)),
         prq_g = mean(c(prq_g_1, prq_g_2)),
         prq_o = mean(c(prq_o_1, prq_o_2)))

lm(prq_a ~ lab, data = DF) %>% 
  anova()

lm(prq_g ~ lab, data = DF) %>% 
  anova()

lm(prq_o ~ lab, data = DF) %>% 
  anova()

DF %>% 
  group_by(lab) %>% 
  summarise(m_prq_a = mean(prq_a),
            m_prq_g = mean(prq_g),
            m_prq_o = mean(prq_o))
```

