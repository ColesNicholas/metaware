y = yi,
size = 1 / (tau2 + vi))) + #  show REML weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / (tau2 + vi)), #  REML weighting
color = "black",
show.legend = FALSE) +
ggtitle("REML weighting")
# estimated relationship between vi and yi is POSITIVE when using FE
p3 <- ggplot(df,
aes(x = vi,
y = yi,
size = 1 / vi)) + # show FE weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / vi), #  FE weighting
color = "black",
show.legend = FALSE) +
ggtitle("FE weighting")
# plot together
grid.arrange(p1, p2, p3)
?grid.arrange
?grid.arrange(p1, p2, p3,
nrow = 2)
grid.arrange(p1, p2, p3,
nrow = 2)
?theme_set
?theme_minimal
library(metafor)
library(ggplot2)
library(gridExtra)
theme_set(theme_minimal(legend.position = "none"))
# load dataframe
df <- read.csv("tmp.df.csv")
# normal funnel plot shows strong negative relationship between vi and yi
p1 <- ggplot(df,
aes(x = vi, y = yi)) +
geom_point() +
ggtitle("funnel plot")
# get tau2 estimate
tau2 <- rma.uni(yi = yi,
vi = vi,
data = df,
method = "REML")$tau2
# estimated relationship between vi and yi is NEGATIVE when using REML
p2 <- ggplot(df,
aes(x = vi,
y = yi,
size = 1 / (tau2 + vi))) + #  show REML weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / (tau2 + vi)), #  REML weighting
color = "black",
show.legend = FALSE) +
ggtitle("REML weighting")
# estimated relationship between vi and yi is POSITIVE when using FE
p3 <- ggplot(df,
aes(x = vi,
y = yi,
size = 1 / vi)) + # show FE weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / vi), #  FE weighting
color = "black",
show.legend = FALSE) +
ggtitle("FE weighting")
# plot together
grid.arrange(p1, p2, p3,
nrow = 2)
ggplot(df,
aes(x = vi,
y = yi,
size = 1 / vi)) + # show FE weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / vi), #  FE weighting
color = "black") +
ggtitle("FE weighting")
library(metafor)
library(ggplot2)
library(gridExtra)
theme_set(theme_minimal(legend.position = "none",
guides(size = FALSE)))
ggplot(df,
aes(x = vi,
y = yi,
size = 1 / (tau2 + vi))) + #  show REML weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / (tau2 + vi)), #  REML weighting
color = "black",
show.legend = FALSE) +
ggtitle("REML weighting")
ggplot(df,
aes(x = vi,
y = yi,
size = 1 / (tau2 + vi))) + #  show REML weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / (tau2 + vi)), #  REML weighting
color = "black",
show.legend = FALSE) +
ggtitle("REML weighting") +
guides(size = FALSE)
ggplot(df,
aes(x = vi,
y = yi,
size = 1 / (tau2 + vi))) + #  show REML weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / (tau2 + vi)), #  REML weighting
color = "black") +
ggtitle("REML weighting") +
guides(size = FALSE)
theme_set(theme_minimal(legend.position = "none",
guides(size = "none")))
ggplot(df,
aes(x = vi,
y = yi,
size = 1 / vi)) + # show FE weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / vi), #  FE weighting
color = "black") +
ggtitle("FE weighting")
theme_set(theme_minimal)
df <- read.csv("tmp.df.csv")
# normal funnel plot shows strong negative relationship between vi and yi
p1 <- ggplot(df,
aes(x = vi, y = yi)) +
geom_point() +
ggtitle("funnel plot")
# get tau2 estimate
tau2 <- rma.uni(yi = yi,
vi = vi,
data = df,
method = "REML")$tau2
# estimated relationship between vi and yi is NEGATIVE when using REML
p2 <- ggplot(df,
aes(x = vi,
y = yi,
size = 1 / (tau2 + vi))) + #  show REML weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / (tau2 + vi)), #  REML weighting
color = "black") +
ggtitle("REML weighting") +
guides(size = "none")
p3 <- ggplot(df,
aes(x = vi,
y = yi,
size = 1 / vi)) + # show FE weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / vi), #  FE weighting
color = "black") +
ggtitle("FE weighting") +
guides(size = "none")
grid.arrange(p1, p2, p3,
nrow = 2)
p1 <- ggplot(df,
aes(x = vi, y = yi)) +
geom_point() +
ggtitle("funnel plot")
p1
library(metafor)
library(ggplot2)
library(gridExtra)
theme_set(theme_minimal())
# load dataframe
df <- read.csv("tmp.df.csv")
# normal funnel plot shows strong negative relationship between vi and yi
p1 <- ggplot(df,
aes(x = vi, y = yi)) +
geom_point() +
ggtitle("funnel plot")
# get tau2 estimate
tau2 <- rma.uni(yi = yi,
vi = vi,
data = df,
method = "REML")$tau2
# estimated relationship between vi and yi is NEGATIVE when using REML
p2 <- ggplot(df,
aes(x = vi,
y = yi,
size = 1 / (tau2 + vi))) + #  show REML weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / (tau2 + vi)), #  REML weighting
color = "black") +
ggtitle("REML weighting") +
guides(size = "none")
# estimated relationship between vi and yi is POSITIVE when using FE
p3 <- ggplot(df,
aes(x = vi,
y = yi,
size = 1 / vi)) + # show FE weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / vi), #  FE weighting
color = "black") +
ggtitle("FE weighting") +
guides(size = "none")
# plot together
grid.arrange(p1, p2, p3,
nrow = 2)
library(metafor)
library(ggplot2)
library(gridExtra)
theme_set(theme_minimal())
# load dataframe
df <- read.csv("tmp.df.csv")
# normal funnel plot shows strong negative relationship between vi and yi
p1 <- ggplot(df,
aes(x = vi, y = yi)) +
geom_point() +
ggtitle("funnel plot")
# get tau2 estimate
tau2 <- rma.uni(yi = yi,
vi = vi,
data = df,
method = "REML")$tau2
# estimated relationship between vi and yi is POSITIVE when using FE
p2 <- ggplot(df,
aes(x = vi,
y = yi,
size = 1 / vi)) + # show FE weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / vi), #  FE weighting
color = "black") +
ggtitle("FE weighting") +
guides(size = "none")
# estimated relationship between vi and yi is NEGATIVE when using REML
p3 <- ggplot(df,
aes(x = vi,
y = yi,
size = 1 / (tau2 + vi))) + #  show REML weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / (tau2 + vi)), #  REML weighting
color = "black") +
ggtitle("REML weighting") +
guides(size = "none")
# plot together
grid.arrange(p1, p2, p3,
nrow = 2)
# Implications: I usually see PET-PEESE implemented with FE weighting.
# In this scenario, the FE weighting will provide an
# very counterintuitive slope estimate
ggplot(df,
aes(x = vi,
y = se,
size = 1 / vi)) + # show FE weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / vi), #  FE weighting
color = "black") +
ggtitle("FE weighting") +
guides(size = "none")
ggplot(df,
aes(x = vi,
y = se,
size = 1 / (tau2 + vi))) + #  show REML weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / (tau2 + vi)), #  REML weighting
color = "black") +
ggtitle("REML weighting") +
guides(size = "none")
ggplot(df,
aes(x = si,
y = yi,
size = 1 / vi)) + # show FE weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / vi), #  FE weighting
color = "black") +
ggtitle("FE weighting") +
guides(size = "none")
df %>% names()
name(df)
names(df)
ggplot(df,
aes(x = se,
y = yi,
size = 1 / vi)) + # show FE weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / vi), #  FE weighting
color = "black") +
ggtitle("FE weighting") +
guides(size = "none")
ggplot(df,
aes(x = se,
y = yi,
size = 1 / (tau2 + vi))) + #  show REML weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / (tau2 + vi)), #  REML weighting
color = "black") +
ggtitle("REML weighting") +
guides(size = "none")
library(metafor)
library(ggplot2)
library(gridExtra)
theme_set(theme_minimal())
# load dataframe
df <- read.csv("tmp.df.csv")
# normal funnel plot shows strong negative relationship between vi and yi
p1 <- ggplot(df,
aes(x = vi, y = yi)) +
geom_point() +
ggtitle("funnel plot")
# get tau2 estimate
tau2 <- rma.uni(yi = yi,
vi = vi,
data = df,
method = "REML")$tau2
# estimated relationship between vi and yi is POSITIVE when using FE
p2 <- ggplot(df,
aes(x = se,
y = yi,
size = 1 / vi)) + # show FE weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / vi), #  FE weighting
color = "black") +
ggtitle("FE weighting") +
guides(size = "none")
# estimated relationship between vi and yi is NEGATIVE when using REML
p3 <- ggplot(df,
aes(x = se,
y = yi,
size = 1 / (tau2 + vi))) + #  show REML weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / (tau2 + vi)), #  REML weighting
color = "black") +
ggtitle("REML weighting") +
guides(size = "none")
# plot together
grid.arrange(p1, p2, p3,
nrow = 2)
# Implications: I usually see PET-PEESE implemented with FE weighting.
# In this scenario, the FE weighting will provide an
# very counterintuitive slope estimate
library(metafor)
library(ggplot2)
library(gridExtra)
theme_set(theme_minimal())
# load dataframe
df <- read.csv("tmp.df.csv")
# normal funnel plot shows strong negative relationship between vi and yi
p1 <- ggplot(df,
aes(x = se, y = yi)) +
geom_point() +
ggtitle("funnel plot")
# get tau2 estimate
tau2 <- rma.uni(yi = yi,
vi = vi,
data = df,
method = "REML")$tau2
# estimated relationship between vi and yi is POSITIVE when using FE
p2 <- ggplot(df,
aes(x = se,
y = yi,
size = 1 / vi)) + # show FE weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / vi), #  FE weighting
color = "black") +
ggtitle("FE weighting") +
guides(size = "none")
# estimated relationship between vi and yi is NEGATIVE when using REML
p3 <- ggplot(df,
aes(x = se,
y = yi,
size = 1 / (tau2 + vi))) + #  show REML weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / (tau2 + vi)), #  REML weighting
color = "black") +
ggtitle("REML weighting") +
guides(size = "none")
# plot together
grid.arrange(p1, p2, p3,
nrow = 2)
# Implications: I usually see PET-PEESE implemented with FE weighting.
# In this scenario, the FE weighting will provide an
# very counterintuitive slope estimate
library(metafor)
library(ggplot2)
library(gridExtra)
theme_set(theme_minimal())
# load dataframe
df <- read.csv("tmp.df.csv")
# normal funnel plot shows strong negative relationship between vi and yi
p1 <- ggplot(df,
aes(x = vi, y = yi)) +
geom_point() +
ggtitle("funnel plot")
# get tau2 estimate
tau2 <- rma.uni(yi = yi,
vi = vi,
data = df,
method = "REML")$tau2
# estimated relationship between vi and yi is POSITIVE when using FE
p2 <- ggplot(df,
aes(x = vi,
y = yi,
size = 1 / vi)) + # show FE weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / vi), #  FE weighting
color = "black") +
ggtitle("FE weighting") +
guides(size = "none")
# estimated relationship between vi and yi is NEGATIVE when using REML
p3 <- ggplot(df,
aes(x = vi,
y = yi,
size = 1 / (tau2 + vi))) + #  show REML weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / (tau2 + vi)), #  REML weighting
color = "black") +
ggtitle("REML weighting") +
guides(size = "none")
# plot together
grid.arrange(p1, p2, p3,
nrow = 2)
# Implications: I usually see PET-PEESE implemented with FE weighting.
# In this scenario, the FE weighting will provide an
# very counterintuitive slope estimate
?weight.funct
library(weightr)
?weightfunct
weight.funct <- weightfunct(effect = df$yi,
v = df$vi,
fe = FALSE)
# FE
weightfunct(effect = df$yi,
v = df$vi,
fe = T)
weightfunct(effect = df$yi,
v = df$vi,
fe = F)
weightfunct(effect = df$yi,
v = df$vi,
fe = T)
weightfunct(effect = df$yi,
v = df$vi,
fe = F)
library(metafor)
library(ggplot2)
library(gridExtra)
library(weightfunct)
theme_set(theme_minimal())
# load dataframe
df <- read.csv("tmp.df.csv")
# normal funnel plot shows strong negative relationship between vi and yi
p1 <- ggplot(df,
aes(x = vi, y = yi)) +
geom_point() +
ggtitle("funnel plot")
# get tau2 estimate
tau2 <- rma.uni(yi = yi,
vi = vi,
data = df,
method = "REML")$tau2
# estimated relationship between vi and yi is POSITIVE when using FE
p2 <- ggplot(df,
aes(x = vi,
y = yi,
size = 1 / vi)) + # show FE weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / vi), #  FE weighting
color = "black") +
ggtitle("FE weighting") +
guides(size = "none")
# estimated relationship between vi and yi is NEGATIVE when using REML
p3 <- ggplot(df,
aes(x = vi,
y = yi,
size = 1 / (tau2 + vi))) + #  show REML weighting for points
geom_point() +
geom_smooth(method = "lm",
mapping = aes(weight = 1 / (tau2 + vi)), #  REML weighting
color = "black") +
ggtitle("REML weighting") +
guides(size = "none")
# plot together
grid.arrange(p1, p2, p3,
nrow = 2)
# selection modeling
## FE
weightfunct(effect = df$yi,
v = df$vi,
fe = T)
## RE
weightfunct(effect = df$yi,
v = df$vi,
fe = F)
library(weightr)
weightfunct(effect = df$yi,
v = df$vi,
fe = T)
weightfunct(effect = df$yi,
v = df$vi,
fe = F)
